# AIえほんメーカー

## サービス概要
1. **AIが生成するストーリーとイラストを組み合わせ、オリジナルの絵本を作成できるサービス**  
   AIを活用して物語と挿絵を自動生成し、自分だけの絵本を簡単に作ることができます。

2. **わずか数ステップで作品を生成し、そのまま閲覧・公開が可能**  
   子ども向けの物語や挿絵を数ステップで自動生成し、すぐに閲覧・公開できます。

3. **多言語対応・決済機能を搭載し、世界中のユーザーに届けられる**  
   多言語化やポイント（クレジット）購入機能にも対応しており、海外のユーザーにも簡単に作品を共有することができます。

## このサービスへの思い・作りたい理由
* **子ども向けの創作物に対する想い**  
  現在、双子を育てており、毎日の育児はとても大変です。絵本の読み聞かせは言語発達にとって重要ですが、多くの絵本を購入すると収納面や持ち運びがかさばるという問題がありました。

* **サービスを思いついたきっかけ**  
  以前から生成AIを取り入れたいと考えていたものの、AI関連のサービスはベースとなるモデルが進化すると陳腐化するケースもあります。しかし「絵本のストーリーとイラストを自動生成するサービス」であれば、モデルの進化に伴いクオリティが高まると考えました。 もちろん、現在のAI生成絵本は既存の市販絵本と比べて完璧な品質に達しているとは言えない面もあります。特に完全自動生成では十分な質を維持するのが難しいかもしれませんが、絵本は子ども向けの読み物という性質上、漫画、小説、アニメなどのコンテンツと比べて多少の矛盾や齟齬は受け入れやすい傾向があります。またAIが生成するイラスト自体のクオリティは近年非常に高まっており、子どもたちが楽しめる十分なレベルにあります。

## 技術スタック

### フロントエンド
- **Next.js 14**: App Routerパターンを採用したフレームワーク
- **TypeScript**: 静的型付けによる安全なコード開発
- **Chakra UI**: モダンなUIコンポーネントライブラリ
- **Framer Motion**: 洗練されたアニメーション実装
- **React PageFlip**: フリップブック形式の絵本ビューア
- **SWR**: データフェッチングとキャッシュ管理

### バックエンド
- **Next.js API Routes**: サーバーサイド機能の実装
- **Prisma ORM**: データベース操作の抽象化
- **PostgreSQL**: リレーショナルデータベース
- **NextAuth.js**: 認証システム（Google OAuthとメール認証）
- **AWS S3**: 画像ストレージ
- **AWS SES**: トランザクションメール送信

### AI生成技術
- **OpenAI GPT-4o**: ストーリー生成とプロンプト改善
- **Stability AI API**: 画像生成（Stable Diffusion Ultra）
- **プロンプトエンジニアリング**: 最適な絵本生成のための手法

### その他の機能
- **Stripe**: クレジットカード決済とサブスクリプション管理
- **next-intl**: 多言語対応（日本語・英語）
- **Google reCAPTCHA**: スパム対策
- **ミドルウェア**: セキュリティヘッダ設定とCSRF対策

## 主要機能

### 1. ユーザー認証・管理
- Google OAuth連携とメールパスワード認証
- メール確認フロー（アカウント有効化）
- パスワードリセット機能
- ユーザープロフィール管理
- アカウント削除・復活機能

### 2. 絵本生成システム
- テーマ、ジャンル、キャラクター、アートスタイルの選択
- AI自動生成によるストーリー作成（GPT-4o）
- ページごとのイラスト生成（Stable Diffusion Ultra）
- 絵本編集機能（タイトル・本文編集、画像再生成）

### 3. 閲覧・共有機能
- フリップブック形式のインタラクティブな閲覧体験
- 没入モード（フルスクリーン表示）
- 公開設定（プライベート、コミュニティ内、完全公開）
- SNS共有機能
- いいね・コメント機能

### 4. クレジット（ポイント）システム
- Stripe決済によるポイント購入
- ポイント消費による絵本生成
- ポイント履歴管理
- コンテンツ公開によるポイント獲得（インセンティブ）

### 5. コミュニティ機能
- 絵本一覧表示と検索フィルター
- いいね・コメント機能
- 人気順・新着順表示
- ユーザーフィードバック収集

## データベース設計
PostgreSQLとPrisma ORMを使用した堅牢なデータモデル:

- **User**: ユーザー情報と認証データ
- **Book**: 絵本のメタデータと公開設定
- **Page**: 絵本のページ内容とイメージ参照
- **PageImage**: 生成された画像の管理（再生成履歴含む）
- **Like/Comment**: ソーシャル機能データ
- **Purchase/PointHistory**: 決済と仮想通貨の管理
- **VerificationToken**: メール認証・パスワードリセット用

## システムアーキテクチャ

### クライアント-サーバーモデル
- Next.jsのApp Routerを使用したハイブリッドレンダリング
- Server ComponentsとClient Componentsの適切な分離
- API Routesによるバックエンド処理の実装
- ミドルウェアによるルート保護と多言語対応

### 状態管理
- SWRを用いたデータフェッチングとキャッシュ戦略
- Contextを活用した状態共有（没入モードなど）
- 楽観的UIアップデートによる高速なユーザー体験

### AI生成フロー
1. ユーザーによるテーマ・設定選択
2. GPT-4oによるストーリー生成
3. 生成された物語からのシーンプロンプト作成
4. Stable Diffusion Ultraによる画像生成
5. 結果のS3保存とデータベース登録
6. ユーザーによる編集と調整オプション

## セキュリティと最適化

### セキュリティ対策
- CSRFトークン検証
- Content Security Policy（CSP）ヘッダ設定
- 入力データの厳格なバリデーション
- Google reCAPTCHA統合
- パスワードのハッシュ化（bcrypt）

### パフォーマンス最適化
- 画像の最適なキャッシング戦略
- SSRとCSRの適切な使い分け
- ページのレイジーロード
- Suspenseによる読み込み状態管理
- Next.js Middlewareの効率的な活用

## ユーザー層について
* **親子（小さなお子様のいる家庭）**
   * 子どもにオリジナルの物語を読み聞かせたい
   * 思い出に残る作品を作りたい などのニーズがあります。

* **保育士・教育関係者**
   * 教育の現場やワークショップで創作絵本を取り入れ、学びの機会を提供したい というニーズがあります。

## サービスの利用イメージ
1. **簡単なテーマやキャラクターの選択だけで物語生成**  
   テーマやキャラクターを入力するだけで、AIがあっという間にオリジナルのストーリーを提案します。

2. **ワンクリックで挿絵を生成**  
   作成されたストーリーをもとにStable Diffusionで挿絵を自動生成。表紙や各ページのイラストがすぐに完成します。

3. **フリップブック形式で閲覧・公開**  
   生成した絵本は、ブラウザ上でページをめくるように読めます。公開設定により家族だけに見せたり、世界中にシェアすることもできます。

4. **購入/ポイント決済機能**  
   ユーザーがクレジット（ポイント）を購入し、そのクレジットを使って絵本を生成する仕組みになっています。

## アプリケーションのフロー
1. **ユーザー登録**：メールまたはGoogleアカウントでサインアップ
2. **ポイント購入**：Stripe決済で利用ポイントを取得
3. **絵本作成**：テーマ・スタイルを選択して生成
4. **編集**：生成された絵本の内容を編集・調整
5. **共有設定**：プライベート保存または公開設定
6. **閲覧・共有**：フリップブック形式で読む、SNSシェア

## デプロイ環境
- **本番環境**: Render
- **データベース**:  PostgreSQL
- **ストレージ**: AWS S3
- **CI/CD**: GitHub Actions




## 必要な環境変数
- OpenAI API Key
- Stability AI API Key
- AWS S3設定
- AWS SES設定
- Stripe API Key
- Google OAuth認証情報
- PostgreSQL接続情報
- NextAuth Secret

## ユーザーの獲得について
* 育児系メディアやSNS、絵本関連のコミュニティとコラボ・広告配信を検討
* 主にSNSマーケティングを中心とし、インフルエンサーとのタイアップなども活用
* 公開コミュニティを活性化し、優良作品の循環による自然な拡散を促進

## サービスの差別化ポイント・推しポイント
1. **誰でも簡単に絵本クリエイター**  
   スキルや専門知識がなくても、AIが物語と挿絵をほぼ自動で生成してくれます。

2. **絵本に特化したプロンプトエンジニアリング**  
   一般的なAI文章生成や画像生成サービスは多々ありますが、あくまで「絵本」に特化。子どもが読んでも違和感のない構成と、キャラクター一貫性を追求しています。

3. **豊富な共有・編集機能**  
   フリップブック形式ビューア、コメント機能、画像再生成など、インタラクティブな体験を提供します。

4. **体系的なUI/UX設計**  
   子育て中の忙しい親御さんでも直感的に操作できる、シンプルでありながら機能性の高いインターフェース設計。

5. **多言語対応・国際展開**  
   日英対応済みのインターフェースと、言語を選択できる絵本生成機能により、グローバル展開の基盤を整備。

## 今後の展望と実装予定機能
1. 動画生成AIによる絵本イラストのアニメーション化
2. 音声読み上げ機能（AI音声合成による朗読）

## 開発者情報
- 個人開発プロジェクト
- 開発期間: 約3ヶ月
- フロントエンド・バックエンド・AI統合の一貫した実装

---

 **画面遷移図**
 Figmaの画面遷移図はこちら：
https://www.figma.com/design/ai4HdeMoEm3K8o7a2a8lZR/AI-Ehon_Review?node-id=0-1&t=L6jeVDdUcJ1uF9iZ-1


## ER図

以下のリンクをクリックするとER図が確認できます。  
[ER図はこちら](./images/ER.png)